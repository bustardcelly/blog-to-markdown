
	
	<h1 class="entry-title full-title"><a href="http://custardbelly.com/blog/2011/02/16/as3flobile-scrollviewport-and-flex-4-containers-from-yeah-to-eh/" title="Permanent link to as3flobile ScrollViewport and Flex 4 containers? from yeah to eh." rel="bookmark" rev="post-373">as3flobile ScrollViewport and Flex 4 containers? from yeah to eh.</a></h1>
	
	<div class="entry-content full-content">
		<p>The other day i got an email from <a href="http://twitter.com/tomkordys" target="_blank">Tom Kordys</a> for a little clarification on the <a href="https://github.com/bustardcelly/as3flobile" target="_blank">as3flobile</a> project and if the <a href="https://github.com/bustardcelly/as3flobile/tree/master/src/com/custardbelly/as3flobile/controls/viewport" target="_blank">ScrollViewport</a> could be used to provide touch scrolling to a <strong>DataGroup</strong>. My first thought was <em>“no”</em>, then my second thought was <em>“why not?”</em>. The third thought i forget. But then the fourth thought was fire up <strong>Flash Builder</strong> and take a break.</p>
<p>When i originally started out creating the <a href="https://github.com/bustardcelly/as3flobile" target="_blank">as3flobile</a> library, the intent was to provide a suite of controls for an <strong>AS3</strong> project targeting the <strong>Flash Player</strong> on a mobile browser. I intentionally pushed <strong>Flex</strong> to the side for a number of reasons:</p>
<ol>
<li><strong>Adobe</strong> is currently <a href="http://labs.adobe.com/technologies/flex/mobile/" target="_blank">working on and improving <strong>Hero</strong></a> (nee <strong>Slider</strong>).</li>
<li>It runs like crap on mobile (hence the first line item).</li>
<li>I wanted to dive into a solely <strong>AS3</strong> personal project again (selfish).</li>
</ol>
<p>Before i got that email, truthfully, the thought never crossed my mind to intermingle parts from the as3flobile library into <strong>Flex</strong>; <strong>Adobe</strong> will deliver their solution in due time and i will then make a decision whether to use <strong>Flex</strong> or <strong>AS3</strong> for my next mobile-web based project. Until then, if need be, i’ll just use <strong>AS3</strong>. That is still my impression, but after i got that email i was just dying to know if i could enable touch scrolling on <strong>Flex 4</strong> containers. </p>
<p>So you’ve read all the way down to here and i still haven’t given an answer…</p>
<p>[view source enabled]<br>
<a href="http://www.custardbelly.com/downloads/as3flobile/containerviewport/" target="_blank"><img src="http://www.custardbelly.com/blog/images/as3flobile_vp_container.png" alt="as3flobile viewport container"></a><br>
<em>ScrollViewport with Group containers.</em></p>
<p>[view source enabled]<br>
<a href="http://www.custardbelly.com/downloads/as3flobile/flexviewport/" target="_blank"><img src="http://www.custardbelly.com/blog/images/as3flobile_vp_datagroup.png" alt="as3flobile viewport datagroup"></a><br>
<em>ScrollViewport with virtualized DataGroup container.</em></p>
<p>Yes, it is possibile! Would i recommend it? Sure, have fun! Would i put it into production? No. No, i would not. </p>
<p>From my tests, <strong>Flex</strong> containers in the <a href="https://github.com/bustardcelly/as3flobile/" target="_blank">as3flobile</a> <strong>ScrollViewport</strong> run pretty smoothly on a desktop browser. If that is your target platform and you are looking for touch-scroll on containers, I say try it out. In <strong>Flash Player</strong> on mobile browser, the scrolling and touch interaction is not smooth enough for my liking, but it may pass your user experience tests… who knows. I believe it is the length of invalidation cycle for <strong>Flex</strong> that is causing the render hiccups, but i am sure there is some optimization that could be done in <a href="https://github.com/bustardcelly/as3flobile/" target="_blank">as3flobile</a> that may help a little. That said, <a href="https://github.com/bustardcelly/as3flobile/" target="_blank">as3flobile</a> touch-scroll runs pretty smoothly on an <strong>AS3</strong> project, so i don’t know how much optimization could be done for me to be comfortable with the rendering performance of Flex containers in an <a href="https://github.com/bustardcelly/as3flobile/" target="_blank">as3flobile</a> <strong>ScrollViewport</strong>. All said, I will explain how you can target a <strong>Flex 4</strong> container as the content for <a href="https://github.com/bustardcelly/as3flobile/" target="_blank">as3flobile</a> <strong>ScrollViewport</strong>.</p>
<h2>as3flobile ScrollViewport</h2>
<p>The <strong>ScrollViewport</strong> control from <a href="https://github.com/bustardcelly/as3flobile/" target="_blank">as3flobile</a> essentially uses its dimensions as a visible area for child content. Its target child content is typed to an <strong>InteractiveObject</strong>, which is the base display class from which touch/mouse events are received on. <strong>Flex</strong> containers subclass (through a larger inheritance chain) <strong>InteractiveObject</strong> so there was no extra effort or cajoling of the as3flobile library to make <strong>ScrollViewport</strong> work with <strong>Flex</strong> containers.</p>
<p>With its content set to <strong>IntractiveObject</strong>, <strong>ScrollViewport</strong> employs the <a href="http://en.wikipedia.org/wiki/Strategy_pattern" target="_blank">Strategy Pattern</a> to recognize interactive events on the content and perform scrolling. You can assign custom scroll contexts and strategies to <strong>ScrollViewport</strong>, but the default context reacts to <strong>Mouse</strong> events invoking the default scroll strategy. The scroll behaviour is based on the <strong>width</strong> and <strong>height</strong> dimensions of the target content for the <strong>ScrollViewport</strong>. If the <strong>height</strong> of the content is less than or equal to the <strong>height</strong> property of <strong>ScrollViewport</strong>, then vertical scrolling is turned off. Likewise for the <strong>width</strong> property values and horizontal scrolling.</p>
<p>To set up a viewport for <strong>AS3</strong>, you would do something of the following:</p>
<div><pre><div class="line number1 index0 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">container:Sprite = </code><code class="jscript keyword">new</code> <code class="jscript plain">Sprite();</code></div><div class="line number2 index1 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">bitmap:Bitmap = </code><code class="jscript keyword">new</code> <code class="jscript plain">Bitmap( </code><code class="jscript keyword">new</code> <code class="jscript plain">BitmapData( 200, 200, </code><code class="jscript keyword">false</code><code class="jscript plain">, 0x000000 ) );</code></div><div class="line number3 index2 alt2"><code class="jscript plain">container.addChild( bitmap );</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="jscript comments">// Direct dimension values</code></div><div class="line number6 index5 alt1"><code class="jscript keyword">var</code> <code class="jscript plain">viewport:ScrollViewport = </code><code class="jscript keyword">new</code> <code class="jscript plain">ScrollViewport();</code></div><div class="line number7 index6 alt2"><code class="jscript plain">viewport.width = 100;</code></div><div class="line number8 index7 alt1"><code class="jscript plain">viewport.height = 100;</code></div><div class="line number9 index8 alt2"><code class="jscript plain">viewport.content = container;</code></div><div class="line number10 index9 alt1"><code class="jscript plain">addChild( viewport );</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="jscript comments">// OR - Utility convenience instantiation</code></div><div class="line number13 index12 alt2"><code class="jscript keyword">var</code> <code class="jscript plain">viewport:ScrollViewport = ScrollViewport.initWithScrollRect( </code><code class="jscript keyword">new</code> <code class="jscript plain">Rectangle( 0, 0, 100, 100 ) );</code></div><div class="line number14 index13 alt1"><code class="jscript plain">viewport.content = container;</code></div><div class="line number15 index14 alt2"><code class="jscript plain">addChild( viewport );</code></div></pre></div>
<p>In this example, the <strong>InteractiveObject</strong> target is the <strong>Sprite</strong> that has a <strong>Bitmap</strong> child. The size of the <strong>Bitmap</strong> (and consequently the parenting size of the <strong>Sprite</strong>) is larger than the designated size for the viewport. In reality this is a terrible example because you won’t really see the scrolling affect due to a single colored bitmap. <em>An example with a loaded bitmap can be seen at <a href="http://www.custardbelly.com/android/froyo/as3flobile" target="_blank">http://www.custardbelly.com/android/froyo/as3flobile</a>.</em></p>
<h2>Targeting Flex 4 containers</h2>
<p>The approach to apply the content of the <strong>ScrollViewport</strong> to a <strong>Flex</strong> container is relatively the same as in the <strong>AS3</strong> example. The only caveat is that you need to listen for a change in the <strong>contentWidth</strong> and <strong>contentHeight</strong> properties of the <strong>Flex</strong> container and refresh the <strong>ScrollViewport</strong> instance. As well, the <strong>ScrollViewport</strong> needs to be added as a child of <strong>SpriteVisualElement</strong>, and the target container re-parented to the <strong>ScrollViewport</strong>. Here is a quick example:</p>
<div><pre><div class="line number1 index0 alt2"><code class="xml plain">&lt;?</code><code class="xml keyword">xml</code> <code class="xml color1">version</code><code class="xml plain">=</code><code class="xml string">"1.0"</code> <code class="xml color1">encoding</code><code class="xml plain">=</code><code class="xml string">"utf-8"</code><code class="xml plain">?&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">s:Group</code> <code class="xml color1">xmlns:fx</code><code class="xml plain">=</code><code class="xml string">"<a href="http://ns.adobe.com/mxml/2009">http://ns.adobe.com/mxml/2009</a>"</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">xmlns:s</code><code class="xml plain">=</code><code class="xml string">"<a href="library://ns.adobe.com/flex/spark">library://ns.adobe.com/flex/spark</a>"</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">xmlns:mx</code><code class="xml plain">=</code><code class="xml string">"<a href="library://ns.adobe.com/flex/mx">library://ns.adobe.com/flex/mx</a>"</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">creationComplete</code><code class="xml plain">=</code><code class="xml string">"handleCreationComplete();"</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">fx:Script</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">&lt;![CDATA[</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">import com.custardbelly.as3flobile.controls.viewport.ScrollViewport;</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">import mx.events.PropertyChangeEvent;</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">protected var viewport:ScrollViewport;</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">protected function handleCreationComplete():void</code></div><div class="line number16 index15 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">{</code></div><div class="line number17 index16 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">container.addEventListener( PropertyChangeEvent.PROPERTY_CHANGE, handleContentPropertyChange, false, 0, true );</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewport = new ScrollViewport();</code></div><div class="line number20 index19 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewport.width = 100;</code></div><div class="line number21 index20 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewport.height = 100;</code></div><div class="line number22 index21 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewport.content = container;</code></div><div class="line number23 index22 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewportHolder.addChild( viewport );</code></div><div class="line number24 index23 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">}</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">protected function handleContentPropertyChange( evt:PropertyChangeEvent ):void</code></div><div class="line number27 index26 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">{</code></div><div class="line number28 index27 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">if( evt.property == "contentWidth" || evt.property == "contentHeight" )</code></div><div class="line number29 index28 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">{</code></div><div class="line number30 index29 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewport.refresh();</code></div><div class="line number31 index30 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">}</code></div><div class="line number32 index31 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">}</code></div><div class="line number33 index32 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">]]&gt;</code></div><div class="line number34 index33 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">fx:Script</code><code class="xml plain">&gt;</code></div><div class="line number35 index34 alt2">&nbsp;</div><div class="line number36 index35 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:SpriteVisualElement</code> <code class="xml color1">id</code><code class="xml plain">=</code><code class="xml string">"viewportHolder"</code> <code class="xml plain">/&gt;</code></div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:Group</code> <code class="xml color1">id</code><code class="xml plain">=</code><code class="xml string">"container"</code> <code class="xml color1">width</code><code class="xml plain">=</code><code class="xml string">"200"</code> <code class="xml color1">height</code><code class="xml plain">=</code><code class="xml string">"200"</code><code class="xml plain">&gt;</code></div><div class="line number39 index38 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:Rect</code> <code class="xml color1">width</code><code class="xml plain">=</code><code class="xml string">"200"</code> <code class="xml color1">height</code><code class="xml plain">=</code><code class="xml string">"200"</code><code class="xml plain">&gt;</code></div><div class="line number40 index39 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:fill</code><code class="xml plain">&gt;</code></div><div class="line number41 index40 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:LinearGradient</code><code class="xml plain">&gt;</code></div><div class="line number42 index41 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:entries</code><code class="xml plain">&gt;</code></div><div class="line number43 index42 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:GradientEntry</code> <code class="xml color1">color</code><code class="xml plain">=</code><code class="xml string">"0x000000"</code> <code class="xml color1">ratio</code><code class="xml plain">=</code><code class="xml string">"0"</code> <code class="xml plain">/&gt;</code></div><div class="line number44 index43 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:GradientEntry</code> <code class="xml color1">color</code><code class="xml plain">=</code><code class="xml string">"0xFFFFFF"</code> <code class="xml color1">ratio</code><code class="xml plain">=</code><code class="xml string">".66"</code> <code class="xml plain">/&gt;</code></div><div class="line number45 index44 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">s:entries</code><code class="xml plain">&gt;</code></div><div class="line number46 index45 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">s:LinearGradient</code><code class="xml plain">&gt;</code></div><div class="line number47 index46 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">s:fill</code><code class="xml plain">&gt;</code></div><div class="line number48 index47 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">s:Rect</code><code class="xml plain">&gt;</code></div><div class="line number49 index48 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">s:Group</code><code class="xml plain">&gt;</code></div><div class="line number50 index49 alt1">&nbsp;</div><div class="line number51 index50 alt2"><code class="xml plain">&lt;/</code><code class="xml keyword">s:Group</code><code class="xml plain">&gt;</code></div></pre></div>
<p>The target content – in this example, a <strong>Group</strong> container with the id of “container” – needs to go through the invalidation cycle within <strong>Flex</strong>. So it is declared in mark-up as a child of the parent <strong>Group</strong>. This is important to note, because the target content container cannot be added from a <strong>Declarations</strong> tag in <strong>Flex</strong>. It needs to have gone through its invalidation in order to be rendered and re-parented to the <strong>ScrollViewport</strong>. Once the container is set as the content for the <strong>ScrollViewport</strong> it is now on the display list of the <strong>ScrollViewport</strong>.</p>
<p>As mentioned early, in this example, i have assigned a <strong>PropertyChangeEvent</strong> listener to pick up the change to <strong>contentWidth</strong> and <strong>contentHeight</strong> of the container. Once caught, the viewport is refreshed. This is needed in order to properly based its scroll bounds in the strategy. Once that is set, you are already to go.</p>
<p>Here is an example of using this approach which shows vertical and horizontal scroll viewports for <strong>Group</strong> containers:</p>
<p>[view source enabled]<br>
<a href="http://www.custardbelly.com/downloads/as3flobile/containerviewport/" target="_blank"><img src="http://www.custardbelly.com/blog/images/as3flobile_vp_container.png" alt="as3flobile viewport container"></a><br>
<em>ScrollViewport with Group containers.</em></p>
<h2>ScrollViewport and virtualized DataGroup renderers</h2>
<p>After drumming up a working example with <strong>Group</strong> container as content target for <strong>ScrollViewport</strong>, my mind immediately changed focus to <strong>DataGroups</strong>. And not just <strong>DataGroup</strong>s, but the need for item renderer recycling using virtualization. I<em>f you are unfamiliar with virualization and <strong>DataGroup</strong>s, <strong>Adobe</strong> has some useful information <a href="http://help.adobe.com/en_US/flex/using/WS64909091-7042-4fb8-A243-8FD4E2990264.html" target="_blank">here</a>.</em></p>
<p>That gets a little trickier, but not too much. Fortunately the <strong>contentWidth</strong> and <strong>contentHeight</strong> property values are updated on a <strong>DataGroup</strong> based on the <strong>dataProvider</strong> and the item renderer using <em>virtualization</em>, even though every data renderer for an item in the <strong>dataProvider</strong> is not present in the layout display stack since they are recycled. In broad terms, this means our scroll strategy will still be a viable solution, but we will need to update the <strong>verticalScrollPosition</strong> and <strong>y</strong> position of the <strong>DataGroup</strong> during the scroll behaviour.</p>
<p>Here is an example of using <strong>DataGroup</strong> with a virtualized layout:</p>
<div><pre><div class="line number1 index0 alt2"><code class="xml plain">&lt;?</code><code class="xml keyword">xml</code> <code class="xml color1">version</code><code class="xml plain">=</code><code class="xml string">"1.0"</code> <code class="xml color1">encoding</code><code class="xml plain">=</code><code class="xml string">"utf-8"</code><code class="xml plain">?&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">s:Group</code> <code class="xml color1">xmlns:fx</code><code class="xml plain">=</code><code class="xml string">"<a href="http://ns.adobe.com/mxml/2009">http://ns.adobe.com/mxml/2009</a>"</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">xmlns:s</code><code class="xml plain">=</code><code class="xml string">"<a href="library://ns.adobe.com/flex/spark">library://ns.adobe.com/flex/spark</a>"</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">xmlns:mx</code><code class="xml plain">=</code><code class="xml string">"<a href="library://ns.adobe.com/flex/mx">library://ns.adobe.com/flex/mx</a>"</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">creationComplete</code><code class="xml plain">=</code><code class="xml string">"handleCreationComplete();"</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">fx:Declarations</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:ArrayList</code> <code class="xml color1">id</code><code class="xml plain">=</code><code class="xml string">"dp"</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;hello&lt;/</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;world&lt;/</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;foo&lt;/</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;</code></div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;bar&lt;/</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;baz&lt;/</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;</code></div><div class="line number14 index13 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;jello&lt;/</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;</code></div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;biafra&lt;/</code><code class="xml keyword">fx:String</code><code class="xml plain">&gt;</code></div><div class="line number16 index15 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">s:ArrayList</code><code class="xml plain">&gt;</code></div><div class="line number17 index16 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">fx:Declarations</code><code class="xml plain">&gt;</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">fx:Script</code><code class="xml plain">&gt;</code></div><div class="line number20 index19 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">&lt;![CDATA[</code></div><div class="line number21 index20 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">import com.custardbelly.as3flobile.controls.viewport.ScrollViewport;</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">import mx.events.PropertyChangeEvent;</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">protected var viewport:ScrollViewport;</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">protected function handleCreationComplete():void</code></div><div class="line number28 index27 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">{</code></div><div class="line number29 index28 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">dataGroup.addEventListener( PropertyChangeEvent.PROPERTY_CHANGE, handleContentPropertyChange, false, 0, true );</code></div><div class="line number30 index29 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">dataGroup.dataProvider = dp;</code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewport = new ScrollViewport();</code></div><div class="line number33 index32 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewport.width = 100;</code></div><div class="line number34 index33 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewport.height = 100;</code></div><div class="line number35 index34 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewport.content = container;</code></div><div class="line number36 index35 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewport.scrollChange.add( handleScrollChange );</code></div><div class="line number37 index36 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewportHolder.addChild( viewport );</code></div><div class="line number38 index37 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">}</code></div><div class="line number39 index38 alt2">&nbsp;</div><div class="line number40 index39 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">protected function handleContentPropertyChange( evt:PropertyChangeEvent ):void</code></div><div class="line number41 index40 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">{</code></div><div class="line number42 index41 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">if( evt.property == "contentHeight" )</code></div><div class="line number43 index42 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">{</code></div><div class="line number44 index43 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">container.height = dataGroup.contentHeight;</code></div><div class="line number45 index44 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">contentBackground.height = dataGroup.contentHeight;</code></div><div class="line number46 index45 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">viewport.refresh();</code></div><div class="line number47 index46 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">}</code></div><div class="line number48 index47 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">}</code></div><div class="line number49 index48 alt2">&nbsp;</div><div class="line number50 index49 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">protected function handleScrollChange( value:Point ):void</code></div><div class="line number51 index50 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">{</code></div><div class="line number52 index51 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">dataGroup.verticalScrollPosition = value.y * -1;</code></div><div class="line number53 index52 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">dataGroup.y = dataGroup.verticalScrollPosition;</code></div><div class="line number54 index53 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">}</code></div><div class="line number55 index54 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color2">]]&gt;</code></div><div class="line number56 index55 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">fx:Script</code><code class="xml plain">&gt;</code></div><div class="line number57 index56 alt2">&nbsp;</div><div class="line number58 index57 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:SpriteVisualElement</code> <code class="xml color1">id</code><code class="xml plain">=</code><code class="xml string">"viewportHolder"</code> <code class="xml plain">/&gt;</code></div><div class="line number59 index58 alt2">&nbsp;</div><div class="line number60 index59 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:Group</code> <code class="xml color1">id</code><code class="xml plain">=</code><code class="xml string">"container"</code> <code class="xml color1">width</code><code class="xml plain">=</code><code class="xml string">"100"</code><code class="xml plain">&gt;</code></div><div class="line number61 index60 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:Rect</code> <code class="xml color1">id</code><code class="xml plain">=</code><code class="xml string">"contentBackground"</code> <code class="xml color1">width</code><code class="xml plain">=</code><code class="xml string">"100"</code><code class="xml plain">&gt;</code></div><div class="line number62 index61 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:fill</code><code class="xml plain">&gt;</code></div><div class="line number63 index62 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:SolidColor</code> <code class="xml color1">color</code><code class="xml plain">=</code><code class="xml string">"#DDDDDD"</code> <code class="xml plain">/&gt;</code></div><div class="line number64 index63 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">s:fill</code><code class="xml plain">&gt;</code></div><div class="line number65 index64 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">s:Rect</code><code class="xml plain">&gt;</code></div><div class="line number66 index65 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:DataGroup</code> <code class="xml color1">id</code><code class="xml plain">=</code><code class="xml string">"dataGroup"</code></div><div class="line number67 index66 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">width</code><code class="xml plain">=</code><code class="xml string">"100"</code> <code class="xml color1">height</code><code class="xml plain">=</code><code class="xml string">"200"</code></div><div class="line number68 index67 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">clipAndEnableScrolling</code><code class="xml plain">=</code><code class="xml string">"true"</code></div><div class="line number69 index68 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">itemRenderer</code><code class="xml plain">=</code><code class="xml string">"spark.skins.spark.DefaultItemRenderer"</code><code class="xml plain">&gt;</code></div><div class="line number70 index69 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:layout</code><code class="xml plain">&gt;</code></div><div class="line number71 index70 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">s:VerticalLayout</code> <code class="xml color1">useVirtualLayout</code><code class="xml plain">=</code><code class="xml string">"true"</code> <code class="xml color1">gap</code><code class="xml plain">=</code><code class="xml string">"2"</code> <code class="xml plain">/&gt;</code></div><div class="line number72 index71 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">s:layout</code><code class="xml plain">&gt;</code></div><div class="line number73 index72 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">s:DataGroup</code><code class="xml plain">&gt;</code></div><div class="line number74 index73 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">s:Group</code><code class="xml plain">&gt;</code></div><div class="line number75 index74 alt2">&nbsp;</div><div class="line number76 index75 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">s:Group</code><code class="xml plain">&gt;</code></div></pre></div>
<p>In this example, we are basing our target content container dimensions on change to the contentHeight property of the <strong>DataGroup</strong> child. The <strong>dataProvider</strong> and the item renderer are the basis of the <strong>contentHeight</strong> property, and once we handle that change, we apply the height properties to the container and contentBackground, then refresh the viewport. The <strong>contentBackground</strong> is there to act as a grabbable area within the container so we can scroll without having to touched down on an item renderer in the <strong>DataGroup</strong> directly.</p>
<p>The handler for the <strong>scrollChange</strong> <a href="https://github.com/robertpenner/as3-signals" target="_blank">Signal</a> then updates the <strong>verticalScrollPosition</strong> of the <strong>DataGroup</strong> and the <strong>y</strong> position within the container. This gives the perceived scrolling display incorporated with item renderer recycling (notice the <strong>useVirtualLayout</strong> property value on the <strong>VerticalLayout</strong> assigned to the <strong>DataGroup</strong>).</p>
<p>Here is an example of this working with the status API of <strong>Twitter</strong> as the data content for a <strong>DataGroup</strong>:</p>
<p>[view source enabled]<br>
<a href="http://www.custardbelly.com/downloads/as3flobile/flexviewport/" target="_blank"><img src="http://www.custardbelly.com/blog/images/as3flobile_vp_datagroup.png" alt="as3flobile viewport datagroup"></a><br>
<em>ScrollViewport with virtualized DataGroup container.</em></p>
<p>You’ll see some lag when each new item renderer is requested to render, but once it has finished and cached the image requests it will get smoother.</p>
<h2>Conclusion</h2>
<p>Cheers to <a href="http://twitter.com/tomkordys" target="_blank">Tom Kordys</a> for looking in to <a href="https://github.com/bustardcelly/as3flobile" target="_blank">as3flobile</a> and sparking the discussion. In short, yeah is it possible to use ScrollViewport and Flex 4 containers. But if you have looked at the examples on a mobile device that supports <strong>Flash Player</strong>, you may agree with me that it is not production-ready. Maybe there is some optimization i could do one my side, but i feel the lag really is on the <strong>Flex</strong> invalidation cycle. As well, these examples are pretty basic and there might be some other fine-tuning, not to mention maybe swapping out the container with a <strong>Bitmap</strong> snapshot of itself while scrolling… something to think about.</p>
<h2>Attribution</h2>
<p>The examples use the <a href="https://github.com/mrdoob/Hi-ReS-Stats">Hi-ReS-Stats component</a> created by <a href="http://mrdoob.com/">Mr.doob</a>.</p>
<p>as3flobile uses the <a href="https://github.com/robertpenner/as3-signals">as3-signals</a> library created by <a href="http://flashblog.robertpenner.com/">Robert Penner</a>.</p>
<p><em><a href="https://github.com/bustardcelly/as3flobile" target="_blank">as3flobile</a> is a set of ActionScript 3 components targeting the Flash Player on mobile devices. <a href="http://custardbelly.com/blog/?page_id=180">You can read more about the project here</a>. To see working examples, visit <a href="http://www.custardbelly.com/android/froyo/as3flobile/">http://www.custardbelly.com/android/froyo/as3flobile/</a></em></p>
		<div class="clear"></div>
	</div><!-- .entry-content-->
	
	<p class="filed categories alt-font tight">Posted in <a href="http://custardbelly.com/blog/category/as3/" title="View all posts in AS3" rel="category tag">AS3</a>,  <a href="http://custardbelly.com/blog/category/flash/" title="View all posts in Flash" rel="category tag">Flash</a>,  <a href="http://custardbelly.com/blog/category/flex/" title="View all posts in Flex" rel="category tag">Flex</a>,  <a href="http://custardbelly.com/blog/category/flex-4/" title="View all posts in Flex 4" rel="category tag">Flex 4</a>,  <a href="http://custardbelly.com/blog/category/as3flobile/" title="View all posts in as3flobile" rel="category tag">as3flobile</a>.</p>
	
	

	<!--/by-line-->

	<div id="post-comments-373-target"></div>
	<div class="clear"></div>
	
	